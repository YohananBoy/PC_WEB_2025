<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cefeteria</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            font-family: "Franklin Gothic Medium", "Arial Narrow", Arial, sans-serif;
        }

        main {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            padding: 20px;
            gap: 20px;
        }

        main section,
        main aside {
            margin: 0 15px;
        }

        section {
            width: max-content;
        }

        header {
            background-color: rgb(255, 220, 64);
            color: #fff;
            padding: 15px 30px;
            text-align: center;
            font-weight: bold;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
        }

        h2 {
            margin: 10px 0;
        }

        .item:hover {
            cursor: pointer;
            transform: scale(1.03);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        #listaCardapio {
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-start;
            align-items: center;
            gap: 20px;
        }

        #listaCardapio .item {
            padding: 20px;
            width: 200px;
            height: 100px;
            display: flex;
            align-items: center;
            gap: 15px;
            border: 3px solid #333;
            border-radius: 15px;
            background-color: #fff;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        #listaComprados {
            width: 300px;
            height: max-content;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        #listaComprados .item {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            padding: 10px;
            border: 2px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
    </style>
</head>

<body>
    <header>
        <h1>CEFETERIA</h1>
    </header>
    <main>
        <section>
            <h2>Cardápio</h2>
            <div id="listaCardapio"></div>
        </section>
        <aside>
            <h2>Itens Comprados</h2>
            <div id="listaComprados"></div>
            <h3>Total</h3>
            <h2 id="total"></h2>
        </aside>
    </main>

    <script>
        const produtos = [
            {
                nome: "Café Expresso",
                preco: 8,
                imagem: "img/cafe-expresso.png",
            },
            {
                nome: "Capuccino",
                preco: 12,
                imagem: "img/capuccino.png",
            },
            {
                nome: "Suco de Laranja",
                preco: 10,
                imagem: "img/suco-de-laranja.png",
            },
            {
                nome: "Água Mineral",
                preco: 6,
                imagem: "img/agua-mineral.png",
            },
            {
                nome: "Fatia de Bolo",
                preco: 12,
                imagem: "img/fatia-de-bolo.png",
            },
            {
                nome: "Sanduíche Natural",
                preco: 15,
                imagem: "img/sanduiche-natural.png",
            },
            {
                nome: "Croissant",
                preco: 17,
                imagem: "img/croissant.png",
            },
        ]

        const listaProdutos = () => {
            const listaCardapio = document.getElementById("listaCardapio")
            produtos.forEach((produto) => {
                const div = document.createElement("div")
                div.classList.add("item")

                let imagem = produto.imagem
                const imagemHtml = document.createElement("img")
                imagemHtml.src = imagem
                imagemHtml.classList.add("img")
                imagemHtml.style.width = "100px"
                div.appendChild(imagemHtml)

                const divAux = document.createElement("div")
                div.appendChild(divAux)

                let nome = produto.nome
                const nomeHtml = document.createElement("h4")
                nomeHtml.textContent = nome
                nomeHtml.classList.add("nome")
                divAux.appendChild(nomeHtml)

                let preco = produto.preco
                const precoHtml = document.createElement("h3")
                precoHtml.textContent = preco + " R$"
                precoHtml.classList.add("preco")
                divAux.appendChild(precoHtml)

                listaCardapio.appendChild(div)

                div.addEventListener("click", () => {
                    let itensComprados = localStorage.getItem("itensComprados") || "";
                    let itens = itensComprados.split("#").filter((texto) => texto != "");

                    let novosItens = [];
                    let itemEncontrado = false;

                    itens.forEach((item) => {
                        let [nome, preco, quantidade] = item.split("|");
                        if (nome == produto.nome) {
                            quantidade = parseInt(quantidade) + 1;
                            novosItens.push(`${nome}|${preco}|${quantidade}`);
                            itemEncontrado = true;
                        } else {
                            novosItens.push(item);
                        }
                    })

                    if (!itemEncontrado) {
                        novosItens.push(`${produto.nome}|${produto.preco}|1`);
                    }
                    localStorage.setItem("itensComprados", novosItens.join("#") + "#");
                    carregaComprado()
                })
            })
        }

        const carregaComprado = () => {
            const listaComprados = document.getElementById("listaComprados")
            listaComprados.innerHTML = ""
            let soma = 0

            let itensComprados = localStorage.getItem("itensComprados") || ""
            itens = itensComprados.split("#").filter((texto) => texto != "")

            itens.forEach((item) => {
                const [nome, preco, quantidade] = item.split("|")
                const precoTotalItem = parseInt(preco) * parseInt(quantidade)
                soma += precoTotalItem

                const div = document.createElement("div")
                div.classList.add("item")

                const p = document.createElement("p")
                p.textContent = `${nome} - ${quantidade}x - ${precoTotalItem} R$`
                div.appendChild(p)

                div.addEventListener("click", () => {
                    let novosItens =
                        itens.filter((i) => !i.includes(nome)).join("#") + "#"
                    localStorage.setItem("itensComprados", novosItens)
                    carregaComprado()
                })
                listaComprados.appendChild(div)
            })
            const totalHtml = document.getElementById("total")
            totalHtml.textContent = soma + " R$"
        }

        listaProdutos()
        carregaComprado()
    </script>
</body>

</html>